<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VIA University College 4. Semester IoT Drivers: OTAA setup steps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VIA University College 4. Semester IoT Drivers
   &#160;<span id="projectnumber">v3.0.0</span>
   </div>
   <div id="projectbrief">Engineering in Software Technology</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lora_setup_to__o_t_a_a.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">OTAA setup steps </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>All the following code must be implemented in the initialisation part of a FreeRTOS task! </dd>
<dd>
Nearly all calls to the driver will suspend the calling task while the driver waits for response from the RN2484 module.</dd></dl>
<p>In this use case, the driver is setup to Over The Air Activation (OTAA).</p>
<ol type="1">
<li>Define the necessary app identification for OTAA join: <div class="fragment"><div class="line"><span class="comment">// Parameters for OTAA join</span></div><div class="line"><span class="preprocessor">#define LORA_appEUI &quot;E81068FC10812076&quot;</span></div><div class="line"><span class="preprocessor">#define LORA_appKEY &quot;3894B87078D8A38B56E419ABCA16043E&quot;</span></div></div><!-- fragment --></li>
<li>Set the module to factory set defaults: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga18ff164420440d1ba74d796b9ace05da">lora_driver_rn2483_factory_reset</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a4cad2105998ad3d407743eadb7e09ebb">LoRA_OK</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// Something went wrong</span></div><div class="line">}</div></div><!-- fragment --></li>
<li>Configure the module to use the EU868 frequence plan and settings: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#gad689bb72ab6e665ab420342c16912b82">lora_driver_configure_to_eu868</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a4cad2105998ad3d407743eadb7e09ebb">LoRA_OK</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// Something went wrong</span></div><div class="line">}</div></div><!-- fragment --></li>
<li>Get the RN2483 modules unique devEUI: <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> dev_eui[17]; <span class="comment">// It is static to avoid it to occupy stack space in the task</span></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga12704234f7cda8db29aaffea918d6e10">lora_driver_get_rn2483_hweui</a>(dev_eui) != <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a4cad2105998ad3d407743eadb7e09ebb">LoRA_OK</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// Something went wrong</span></div><div class="line">}</div></div><!-- fragment --></li>
<li>Set the necessary LoRaWAN parameters for an OTAA join: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga558c7f15959a8b3b81da75bdff71c74e">lora_driver_set_otaa_identity</a>(<a class="code" href="lorawan__config_8h.html#ad59a97d21942f16ea979c5957f82f212">LORA_appEUI</a>,<a class="code" href="lorawan__config_8h.html#aa9e0befe914ef865548cf69dae9ee274">LORA_appKEY</a>,dev_eui) != <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a4cad2105998ad3d407743eadb7e09ebb">LoRA_OK</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// Something went wrong</span></div><div class="line">}</div></div><!-- fragment --></li>
<li>Save all set parameters to the RN2483 modules EEPROM (OPTIONAL STEP): <dl class="section note"><dt>Note</dt><dd>If this step is performed then it is no necessary to do the steps above more than once. These parameters will automatically be restored in the module on next reset or power on.</dd></dl>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#gaa867602d5eb112949509ffa46bfd1268">lora_driver_save_mac</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a4cad2105998ad3d407743eadb7e09ebb">LoRA_OK</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// Something went wrong</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// All parameters are now saved in the module</span></div></div><!-- fragment --></li>
<li>Join LoRaWAN parameters with OTAA: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga6129a7a1d2ff0431af647725aedf8c12">lora_driver_join</a>(<a class="code" href="group__lora__config.html#ggafa77b1b9c0ed0930a3e2992c177faa54a1581239ce948a94e0ef4557d35eab3a1">LoRa_OTAA</a>) == <a class="code" href="group__lora__driver__return__codes.html#ggae3d2e18f9951939cf15c88ab1ab33ed8a9696ffe63a94b40f7f072a464eca2faa">LoRa_ACCEPTED</a>)</div><div class="line">{</div><div class="line">       <span class="comment">// You are now joined</span></div><div class="line">}</div></div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="lora_driver_quickstart.html">Quick start guide for RN2483 based LoRa Driver</a></li>
    <li class="footer">Generated on Sun Feb 16 2020 16:16:32 for VIA University College 4. Semester IoT Drivers by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
